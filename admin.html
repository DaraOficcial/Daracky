<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Admin Portal</title>
<style>
body{font-family:sans-serif;background:#0f172a;color:#fff;padding:20px}
table{width:100%;border-collapse:collapse;margin-top:15px}
th,td{border-bottom:1px solid rgba(255,255,255,0.2);padding:8px;text-align:left}
button{padding:6px 10px;border:none;border-radius:6px;margin-right:5px;cursor:pointer}
.allow{background:#06b6d4;color:#062024}
.deny{background:#ef4444}
.refresh{background:#22c55e;color:#fff;margin-bottom:10px}
</style>
</head>
<body>
<h2>Admin Panel â€” Portal Tongkrongan</h2>
<button class="refresh" id="refresh">Refresh</button>
<table>
  <thead><tr><th>Nama</th><th>Kata-kata</th><th>Status</th><th>Aksi</th></tr></thead>
  <tbody id="userlist"></tbody>
</table>

<script>
async function loadUsers(){
  const res = await fetch('api/get_users.php');
  const data = await res.json();
  const tbody = document.getElementById('userlist');
  tbody.innerHTML = '';
  data.forEach(u=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${u.nama}</td>
      <td>${u.kata}</td>
      <td>${u.status}</td>
      <td>
        <button class="allow" onclick="updateUser('${u.id}','allow')">Izinkan</button>
        <button class="deny" onclick="updateUser('${u.id}','deny')">Tolak</button>
        <button onclick="updateUser('${u.id}','kill')">Kill</button>
      </td>`;
    tbody.appendChild(tr);
  });
}

async function updateUser(id, action){
  await fetch('api/update_user.php', {
    method: 'POST',
    headers: {'Content-Type':'application/x-www-form-urlencoded'},
    body: `id=${encodeURIComponent(id)}&action=${encodeURIComponent(action)}`
  });
  loadUsers();
}

document.getElementById('refresh').onclick = loadUsers;
loadUsers();
</script>
</body>
</html>
